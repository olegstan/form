{"version":3,"file":"useDropdownLogic.js","names":["_react","require","_createForOfIteratorHelper","r","e","t","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","_n","F","s","n","done","value","f","TypeError","o","a","u","call","next","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_arrayLikeToArray","toString","slice","constructor","name","from","test","l","i","Object","push","useDropdownLogic","exports","props","wrapperRef","onSearch","handle","_useState","useState","_useState2","selectOpen","setSelectOpen","_useState3","_useState4","focused","setFocused","_useState5","_useState6","hovered","setHovered","_useState7","_useState8","handleArrow","setHandleArrow","_useState9","search","_useState0","searchValue","setSearchValue","_useState1","_useState10","selectedItem","setSelectedItem","handleClickOutside","useCallback","current","contains","target","onOutsideClick","handleShowSelect","stopHandleArrows","useEffect","document","addEventListener","removeEventListener","onKeyDown","event","_props$items","items","searchLower","toLowerCase","filteredItems","filter","item","parts","split","partsFound","_iterator","_step","_item$name","part","replacedPart","replace","replacedName","indexOf","err","key","prev","preventDefault","window","startHandleArrows","bool","onChange"],"sources":["../../../../src/Form/Dropdown/hooks/useDropdownLogic.js"],"sourcesContent":["import {useCallback, useEffect, useState} from 'react';\r\n\r\nexport const useDropdownLogic = (props, wrapperRef, onSearch, handle) => {\r\n  const [selectOpen, setSelectOpen] = useState(false);\r\n  const [focused, setFocused] = useState(false);\r\n  const [hovered, setHovered] = useState(false);\r\n  const [handleArrow, setHandleArrow] = useState(false);\r\n  const [searchValue, setSearchValue] = useState(props.search || '');\r\n  const [selectedItem, setSelectedItem] = useState(null);\r\n\r\n  // Обработка клика вне компонента\r\n  const handleClickOutside = useCallback((e) => {\r\n    if (wrapperRef.current && !wrapperRef.current.contains(e.target)) {\r\n      if (typeof props.onOutsideClick === 'function' && focused) {\r\n        props.onOutsideClick(searchValue, selectedItem);\r\n      }\r\n      handleShowSelect(false);\r\n      stopHandleArrows();\r\n    }\r\n  }, [focused, props, searchValue, selectedItem, wrapperRef]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n      stopHandleArrows();\r\n    };\r\n  }, [handleClickOutside]);\r\n\r\n  // Обработка событий клавиатуры\r\n  const onKeyDown = useCallback((event) => {\r\n    const { items = [] } = props;\r\n\r\n    let searchLower = (searchValue || '').toLowerCase();\r\n    let filteredItems = items.filter((item) => {\r\n      if (!searchLower) return true;\r\n      const parts = searchLower.split(' ');\r\n      let partsFound = 0;\r\n      for (let part of parts) {\r\n        const replacedPart = part.replace('ё', 'е').replace('й', 'и');\r\n        const replacedName = item?.name?.toLowerCase().replace('ё', 'е').replace('й', 'и');\r\n        if (replacedPart.length > 0 && replacedName?.indexOf(replacedPart) !== -1) {\r\n          partsFound++;\r\n        }\r\n      }\r\n      return partsFound > 0;\r\n    });\r\n\r\n    switch (event.key) {\r\n      case 'Down':\r\n      case 'ArrowDown':\r\n        if (hovered === false) {\r\n          setHovered(0);\r\n        } else {\r\n          const length = filteredItems.length;\r\n          const next = hovered + 1;\r\n          if (next <= length - 1) {\r\n            setHovered(next);\r\n          }\r\n        }\r\n        break;\r\n      case 'Up':\r\n      case 'ArrowUp': {\r\n        const prev = hovered - 1;\r\n        if (prev >= 0) {\r\n          setHovered(prev);\r\n        }\r\n        break;\r\n      }\r\n      case 'Enter':\r\n        if (hovered !== false && filteredItems[hovered]) {\r\n          const item = filteredItems[hovered];\r\n          if (typeof handle === 'function') {\r\n            handle(item);\r\n          }\r\n          handleShowSelect(false);\r\n          stopHandleArrows();\r\n          setSearchValue(item.name);\r\n          setSelectedItem(item);\r\n        }\r\n        event.preventDefault();\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n  }, [props, hovered, searchValue, handle]);\r\n\r\n  useEffect(() => {\r\n    if (handleArrow) {\r\n      window.addEventListener('keydown', onKeyDown, true);\r\n    }\r\n    return () => {\r\n      window.removeEventListener('keydown', onKeyDown, true);\r\n    };\r\n  }, [handleArrow, onKeyDown]);\r\n\r\n  const startHandleArrows = useCallback(() => {\r\n    if (!handleArrow) {\r\n      setHandleArrow(true);\r\n    }\r\n  }, [handleArrow]);\r\n\r\n  const stopHandleArrows = useCallback(() => {\r\n    setHandleArrow(false);\r\n  }, []);\r\n\r\n  const handleShowSelect = useCallback((bool) => {\r\n    setSelectOpen(bool);\r\n    setFocused(bool);\r\n\r\n    if (bool) {\r\n      startHandleArrows();\r\n    } else {\r\n      stopHandleArrows();\r\n    }\r\n  }, [startHandleArrows, stopHandleArrows]);\r\n\r\n  const onChange = useCallback((e) => {\r\n    const value = e.target.value;\r\n    setSearchValue(value);\r\n    onSearch(value);\r\n  }, [onSearch, props]);\r\n\r\n  return {\r\n    selectOpen,\r\n    focused,\r\n    hovered,\r\n    handleArrow,\r\n    searchValue,\r\n    selectedItem,\r\n    setSearchValue,\r\n    setSelectedItem,\r\n    handleShowSelect,\r\n    onChange,\r\n    onKeyDown,\r\n    startHandleArrows,\r\n    stopHandleArrows,\r\n  };\r\n};"],"mappings":"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","ignoreList":[]}